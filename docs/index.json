[{"categories":["azure-devops"],"contents":"Below is a simple step that verifies if docker exists validating existence of docker.service, if not it installs.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 steps: - script: | if systemctl --all --type service | grep -Fq \u0026#39;docker\u0026#39;; then echo \u0026#34;docker.service exists\u0026#34; else sudo yum install --assumeyes docker sudo usermod -a -G docker ec2-user sudo systemctl enable docker.service sudo systemctl start docker.service sudo systemctl status docker.service --no-pager docker version echo \u0026#34;Docker Installed\u0026#34; fi displayName: Install docker ","date":"Mar 11","permalink":"https://sergsoares.github.io/posts/install-docker-azure-pipelines/","tags":null,"title":"Install Docker inside Amazon Linux inside Azure Pipelines"},{"categories":["make"],"contents":"It is a simple template that i use frequently to initiate projects with Makefile.\n1 2 3 4 5 6 7 8 9 10 11 12 13 .PHONY: help # Show this help. help: @awk \u0026#39;/^#/{c=substr($$0,3);next}c\u0026amp;\u0026amp;/^\\[\\[:alpha:\\]\\]\\[\\[:alnum:\\]\\_-\\]+:/{print substr($$1,1,index($$1,\u0026#34;:\u0026#34;)),c}1{c=0}\u0026#39; $(MAKEFILE\\_LIST) | column -s: -t # Turn on docker-compose environment. up: @docker-compose up -d # Turn on docker-compose environment. down: @docker-compose down -d It use a help recipe in Make that process the comments on top of each task, providing descriptions for tasks and allowing discovery from other that use the project.\nThen when some run make inside the project, will generate the following output:\n$ make help Show this help. up Turn on docker-compose environment. down Turn on docker-compose environment ","date":"Jan 31","permalink":"https://sergsoares.github.io/posts/2023-01-31-a-good-start-template-for-makefile/","tags":null,"title":"A good start template for Makefile"},{"categories":["learn"],"contents":"Looking at Hacker news, i saw a post call my attention.\nI rewrote in Crystal my tool to quickly create Kubernetes clusters in Hetzner\nAnd it called my attention for several factors:\nCreate tooling that envolve K8S.\nUsing a not too mainstream language (Crystal).\nA useful use case inside a real cloud vendor (Hetzner).\nI liked the insights that it give for me and the execution plan from the author, a lot of details need to be managed for the tool work.\nThe app use too configuration file, and take care of Idempotency (the main problema normally) and the update and delete operations for the created infrastructure.\nInspiring see that type of project\n","date":"Dec 31","permalink":"https://sergsoares.github.io/posts/2022-12-31-exploration-and-try-new-ideas-are-a-awesome-way-to-learn/","tags":null,"title":"Exploration and try new ideas are a awesome way to learn"},{"categories":["linux"],"contents":"Grep is an awesome linux app that is used for filtering text data, but sometimes we want more that only the lines of the match text.\ngrep -A 1 # got 1 line after match grep -B 1 # got 1 line before match grep -C 1 # got before and after ","date":"Sep 15","permalink":"https://sergsoares.github.io/posts/2022-09-15-show-more-lines-in-a-grep-filter/","tags":null,"title":"Show more lines in a grep filter."},{"categories":["eks","k8s","aws"],"contents":"Após configuração do cluster de Kubernetes usando o EKS e instalação do metric server, ao se executar o comando para obter o uso de recursos atuais dos nodes, o seguinte erro aparece:\n$ kubectl top nodes error: metrics not available yet ... Após verificar as issues do GitHub para entender melhor o cenários, a mais relevante foi EKS v1.22 \u0026ldquo;Error from server (ServiceUnavailable): the server is currently unable to handle the request (get nodes.metrics.k8s.io) reproduzindo o mesmo cenário.\nSeguindo o fluxo de troubleshooting recomendado foi possível verificar o erro dentro do componente, onde o control plane não consegue se comunicar com com a api de métricas do node:\n$ kubectl get apiservices.apiregistration.k8s.io v1beta1.metrics.k8s.io ... $ kubectl describe apiservices v1beta1.metrics.k8s.io Message: failing or missing response from https://10.46.5.75:4443/apis/metrics.k8s.io/v1beta1: Get \u0026#34;https://10.46.5.75:4443/apis/metrics.k8s.io/v1beta1\u0026#34;: net/http: request canceled while waiting for connection (Client.Timeout exceeded while awaiting headers) ... Após confirmado, foi feito a liberação para o Control Plane conseguir acessar a porta 4443 do Node Group via Security Group, resolvendo o problema e conseguindo obter as métricas de nodes e pods.\n","date":"Sep 02","permalink":"https://sergsoares.github.io/posts/2022-09-02-problema-com-metric-server-no-eks/","tags":null,"title":"Metric server não respondendo no EKS"},{"categories":["k8s"],"contents":"Muitas vezes precisamos copiar um secret do kubernetes de um namespace para outro, visto que não temos a funcionalidade de secrets globais.\nPara isso podemos executar o camando abaixo, que exporta o manifesto de um secret, substitui o nome do namespace no manifesto e aplica no cluster novamente:\n1 kubectl get secret aws --namespace=namespace1 -o yaml | sed \u0026#39;s/namespace: .*/namespace: namespace2/\u0026#39; | kubectl apply -f - ","date":"Aug 16","permalink":"https://sergsoares.github.io/posts/2022-08-16-copiar-kubernetes-secret-entre-namespaces/","tags":null,"title":"Copiar kubernetes secret entre namespaces"},{"categories":["k8s"],"contents":"Um orquestrador é um software desenvolvido para gerenciar containers em um ambiente distribuído entre máquinas virtuais, sendo o componente de controle nesse cenário distribuído suas principais características são:\nPermitir distribuir a carga de trabalho entre as diversas máquinas. Garantir que o ciclo de vida do container seja feito com sucesso (desde sua criação até finalização). Manter a gestão dos recursos entre as diversas máquinas, permitindo que um container que não tem recurso disponível na máquina A seja criado na máquina B. Entre as opções disponíveis temos os orquestradores próprios das cloud\u0026rsquo;s como AWS ECS, Azure Container Instance e o Google Cloud Run.\nJá entre os orquestradores open source (que podem também ter opções gerenciadas na nuvem) temos o Kubernetes, Nomad, Docker Swarm e OpenShift.\n","date":"Aug 08","permalink":"https://sergsoares.github.io/posts/2022-08-08-o-que-e-um-orquestrador-de-containers/","tags":null,"title":"O que é um orquestrador de containers ?"},{"categories":["rancher"],"contents":"O Rancher Desktop é uma aplicação multiplataforma feita pela SUSE que fornece mecanismos para gestão de containers e uma interface gráfica para\na instalação de um cluster Kubernetes local.\nAs principais facilidades de utilizar o Rancher Desktop:\nO pacote de instalação já instala o Nerdctl para gestão das imagens e execução dos containers. Permite que as imagens criadas já sejam utilizadas dentro do Kubernetes. Permite implantar um cluster de Kubernetes utilizando a distribuição K3S sendo possível escolher a versão que se desejada instalar através da interface gráfica. O fluxo para iniciar e finalizar o sistema não tem necessidade de scripts. Já instala um dashboard para o Kubernetes local. Possui uma ferramenta visual para criação de redirecionamento de porta entre o cluster o ambiente local. Cria o cluster com um ingress controller o Traefik, facilitando a exposição dos serviços. Efetua a criação de uma máquina virtual no MacOs e Windows de maneira transparente, sem necessidade de instalação de componentes extras. A documentação do Rancher Desktop é completa e conta com diversos tutoriais para se criar aplicações utilizando o cluster Kubernetes provisionado e a integração com outras aplicações.\n","date":"Aug 05","permalink":"https://sergsoares.github.io/posts/2022-08-05-o-que-e-o-rancher-desktop/","tags":null,"title":"O que é o Rancher Desktop ?"},{"categories":["oci","container"],"contents":"Creio que já viu em blogs técnicos, documentações e posts no dia a dia de trabalho o termo OCI sempre relacionado a docker e containers, mas o que de fato é OCI e como ele tem relação com docker/containers ?\nOCI é a sigla para Open Container Initiative que seria uma organização criada por empresas relacionados a tecnologia de container como a Docker, Inc (empresa por trás da ferramenta docker) e que tem como objetivo prover um padrão para:\nEspecificação do runtime (ambiente de execução) dos containers. Especificação para o padrão de images que deve ser utilizado. O foco seria garantir a interoperabilidade de images criadas por outras ferramentas que seguem o padrão OCI permitindo que images criadas com docker possa ser utilizadas em outros container engines como podman por exemplo.\nPara obter mais informações, é possível consultar o site do Open Container Initiative.\n","date":"Aug 04","permalink":"https://sergsoares.github.io/posts/2022-08-04-o-que-oci-tem-a-ver-com-a-ver-com-containers/","tags":null,"title":"O que OCI tem a ver com a ver com containers ?"},{"categories":["podman","container"],"contents":"O Podman é uma ferramenta de linha de comando para execução de containers, sendo uma alternativa ao docker, mas quais são suas principais características?\nDaemonless - O Docker é uma ferramenta que precisa ser instalada com privilégios de usuário root, enquanto o podman por ser daemonless não precisa desses mesmos privilégios facilitando o seu uso.\nRootless - O podman aplica o conceito de rootless para a execução dos seus containers reduzindo a superfície de ataque através de um container infectado ao host, atualmente já temos o suporte no docker nas novas versões.\nVale a pena também olha a a documentação do podman que conta com excelentes explicações a respeito do uso de containers e dos conceitos envolvidos.\n","date":"Aug 03","permalink":"https://sergsoares.github.io/posts/2022-08-03-por-que-usar-o-podman-se-temos-o-docker/","tags":null,"title":"Por que usar o podman se temos o Docker ?"},{"categories":["packer"],"contents":"We have several options to discover an AMI id to use in infra as code resources, but with Packer from Hashicorp it is simple as define a block that will recover based on a pattern the id.\nAbove the solution using filter to restore latest image id for a ubuntu 20.04 version.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 source \u0026#34;amazon-ebs\u0026#34; \u0026#34;ubuntu\u0026#34; { ami_name = \u0026#34;azure-agent-image-v0.1\u0026#34; instance_type = \u0026#34;t3.micro\u0026#34; region = \u0026#34;eu-west-2\u0026#34; source_ami_filter { filters = { name = \u0026#34;ubuntu/images/*ubuntu-*-20.04-amd64-server-*\u0026#34; root-device-type = \u0026#34;ebs\u0026#34; virtualization-type = \u0026#34;hvm\u0026#34; } most_recent = true owners = [\u0026#34;099720109477\u0026#34;] } ssh_username = \u0026#34;ubuntu\u0026#34; } References https://lgallardo.com/2018/01/25/how-to-get-the-latest-ubuntu-ami/ https://blog.gruntwork.io/locating-aws-ami-owner-id-and-image-name-for-packer-builds-7616fe46b49a ","date":"Mar 30","permalink":"https://sergsoares.github.io/posts/2022-03-30-restoring/","tags":null,"title":"Restoring AMI with Packer"},{"categories":["security"],"contents":"Today with digital products that interact in our day to day increasing the number of security assets that we need to manage is increasing too (password, key files, 2FA components).\nAnd if you are part of a critical infrastructure role or you have ownership inside a company, there are more items and in some cases more critical.\nSome items that can be need managed and exists in multiple contexts (company tenant\u0026rsquo;s, work/personal).\nSSH Keys (Github, Hosts) Cloud 2FA Financial 2FA Crypto 2FA Password Management (Password and other auth methods like files) Email (Proton/Gmail/Outlook) Internal Admin systems (Active Directory) Password for Smartphones Hardware wallets ","date":"Mar 15","permalink":"https://sergsoares.github.io/posts/2022-03-15-more-digital-products-more-security-assets/","tags":null,"title":"More digital products, more security assets"},{"categories":["technical"],"contents":"A list of great technical blogs of companies and organizations that write about sre, kubernetes and other infrastructure topics, it will be updated.\nhttps://sensu.io/blog/ https://www.metricfire.com/blog/ https://sysdig.com/blog/ https://containerjournal.com/ https://tailscale.com/blog/ https://blog.replit.com/ https://www.observability.blog/ https://grafana.com/categories/engineering/ https://www.sentinelone.com/blog/ https://openmetrics.io/ https://fly.io/blog/ https://slack.engineering/ https://www.weave.works/blog/ https://www.padok.fr/en/blog/ https://blog.logrocket.com/ https://www.cncf.io/blog ","date":"Mar 11","permalink":"https://sergsoares.github.io/posts/2022-03-11-technical-blogs-for-sre-infra/","tags":["technical"],"title":"Technical blogs for SRE/Infra"},{"categories":["reflection"],"contents":"As become experienced we start discuss and dialogue with ourself about methodologies and practices.\nWhat we learn touch the reality but with several new and not expected variables, that makes us rethink based on that specific use case.\nIt lead us to change ideas, plans and decisions because we then learn that neither everything can be solved use same tactics and it bring a lot of new challenge that make us enjoy more the process.\n","date":"Mar 02","permalink":"https://sergsoares.github.io/posts/2022-03-02-more-experience-give-us-less-certainties/","tags":null,"title":"More experience give us less certainties"},{"categories":["linux"],"contents":"Each distro in linux can have different paths for install applications, but a good generic option seems:\n/opt/\u0026lt;app_folder\u0026gt;/\u0026lt;executable\u0026gt; https://unix.stackexchange.com/questions/127076/into-which-directory-should-i-install-programs-in-linux ","date":"Mar 01","permalink":"https://sergsoares.github.io/posts/2022-03-01-best-generic-folder-for-linux-apps/","tags":null,"title":"Best generic folder for linux apps"},{"categories":null,"contents":" Test Errors be part of our day work at tech, but working with open source facilitate a lot, tools like terraform show us that community has power.\nAt work today received the below error in a \u0026ldquo;terraform plan\u0026rdquo;:\nStack trace from the terraform-provider-aws_v3.74.0_x5 plugin: panic: interface conversion: interface {} is nil, not *conns.AWSClient And with a fast search I found a Github Issue in Terraform recommending update Terraform version.\nErrors are not cool, but solved issues are.\nBetter yet using Arkade it was an easy activity only doing:\narkade get terraform@1.0.9 And went back to my main activity.\n","date":"Mar 01","permalink":"https://sergsoares.github.io/posts/2022-03-01-solved-issues-are-great-in-open-source/","tags":["terraform","oss"],"title":"Solved issues are great in open source terraform"},{"categories":["docker"],"contents":"Sempre achei interessante a ideia de rodar aplicações gráficas utilizando container e poder facilitar a replicação delas em diferentes locais.\nPesquisando anos atrás formas de utilizar o docker para esse fim vi posts excelentes como do Somatório - Rodando aplicações GUI em Docker e da Jessie - Docker Containers on the Desktop.\nEntretanto esses cenários são para aplicações específicas, não para o ambiente de trabalho inteiro, recentemente pesquisando formas criar um home lab privado e implicações de segurança pensei em criar uma VM com interface gráfica na cloud:\nRunning Ubuntu Desktop GUI (AWS EC2 Instance) on Windows Your desktop on Google Cloud Platform Porém o que mais me surpreendeu foi o Running GUI apps securely in docker (sandbox) que tem um repositório docker-ubuntu-vnc-desktop muito bem organizado e trás como uma opção criar um container com ambiente gráfico Lxde/Lxqt.\nNos testes tanto local quanto em uma VM na GCP funcionou muito bem a navegação e edição de código através dele, o docker in docker funcionou normalmente e ajustando a configuração de resolução permitiu ter uma experiência agradável de uso no VNC Viewer\nPretendo criar um fork do projeto e customizar a image para usos próprios.\n","date":"Apr 26","permalink":"https://sergsoares.github.io/posts/2020-04-26-example-post-3/","tags":null,"title":"Como utilizar docker como ambiente de trabalho"},{"categories":["side-project"],"contents":"Keep an personal blog is common in IT but beyond expose yourself to others and increase your visibility it improve our write skills, tecnical learning and help others with tips/insights.\nIn a past i already try write with frequency but fall in the side-project trap:\nThe main points to avoid fall in this trap again:\nKeep blog simple and focus in content Small and simple posts to gain cadency Talk about work insights and problems solved Trying again this habit, using Hugo a static generator really fast made in Go and starting from Minimal template created by Lukas Joswiak.\n","date":"Apr 26","permalink":"https://sergsoares.github.io/posts/2020-04-26-example-post-2/","tags":null,"title":"Doing exposes reality"},{"categories":null,"contents":"","date":"Jan 01","permalink":"https://sergsoares.github.io/articles/","tags":null,"title":"Articles"}]